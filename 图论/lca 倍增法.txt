#include <iostream>
#include <algorithm>
#include <string>
#include <cstring>
#include <stack>
#include <deque>
#include <cmath>
#include <queue>
#include <set>
#include <bitset>
#include <map>
#include <unordered_map>
using namespace std;
//#define int long long
const int N=4e4+10;
int n,a,b,m,x,y;
vector<int> arr[N];
int depth[N],fa[N][16];

void bfs(int root)
{
  memset(depth,0x3f,sizeof depth);
  depth[0]=0,depth[root]=1;
  queue<int> q;
  q.push(root);
  while(!q.empty())
  {
    int t=q.front();
    q.pop();
    for(auto j:arr[t])
    {
      if(depth[j]>depth[t]+1)
      {
        depth[j]=depth[t]+1;
        q.push(j);
        fa[j][0]=t;//j往上跳一步是t
        for(int k=1;k<=15;k++)
        {
          fa[j][k]=fa[fa[j][k-1]][k-1];
        }
      }
    }
  }
}

int lca(int a,int b)
{
  if(depth[a]<depth[b])
  {
    swap(a,b);
  }
  for(int k=15;k>=0;k--)
  {
    if(depth[fa[a][k]]>=depth[b])
    {
      a=fa[a][k];
    }
  }
  if(a==b)
  return a;
  for(int k=15;k>=0;k--)
  {
    if(fa[a][k]!=fa[b][k])
    {
      a=fa[a][k];
      b=fa[b][k];
    }
  }
  return fa[a][0];
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);
    
    cin>>n;
    int root;
    for(int i=1;i<=n;i++)
    {
      cin>>a>>b;
      if(b==-1) root=a;
      else
      {
      arr[a].push_back(b);
      arr[b].push_back(a);
      }
    }
    cin>>m;
    bfs(root);
    while(m--)
    {
      cin>>x>>y;
      int res=lca(x,y);
      if(res==x)
      {
        cout<<1<<endl;
      }
      else if(res==y)
      {
        cout<<2<<endl;
      }
      else cout<<0<<endl;
    }

    return 0;
}